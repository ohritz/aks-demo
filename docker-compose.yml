version: "3.9"

networks:
  cb-demo-local:
    external: true

services:
  products-db:
    image: mongo
    ports:
      - 27017:27017
    networks:
      - default
    hostname: localhost
  sqlserver:
    image: price-api-sqlserver
    build:
      context: ./data/price-db
      dockerfile: Dockerfile
    environment:
      - MSSQL_SA_PASSWORD=$MSSQL_SA_PASSWORD
    networks:
      - default
    ports:
      - "1433:1433"
    hostname: localhost
  products-api:
    image: products-api
    build:
      context: ./src/products-api
      dockerfile: Dockerfile
    depends_on:
      - products-db
    networks:
      - default
    environment:
      - PORT=3020
      - MONGO_DB_URL=mongodb://products-db:27017/products
    ports:
      - "3020:3020"
    hostname: localhost
